<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>DimSim - a phosphene simulator for mobile phones</title>
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1f00d0beadf87bad7d275c174616e048f8b573fc/dist/aframe-master.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <script>
      AFRAME.registerPrimitive('a-phosphene', {
        defaultComponents: {
          phosphene: {},
          geometry: { primitive: 'circle', radius: '0.035' },
          material: { color: 'white', opacity: '1' },
          position: { x:0, y:0, z:-1 } // Assumes x-range -0.5 <= x <= 0.5, and y-range -0.4 <= y <= 0.4
        },

        mappings: {
          intensity: 'material.opacity',
          x: 'position.x',
          y: 'position.y'
        }
      })
    </script>
  </head>
  <body>
    <a-scene background="color:black">
      <a-entity camera look-controls="enabled: false; touchEnabled: false; magicWindowTrackingEnabled: false">
        <a-phosphene id="p10001" x="-0.3" y="0.15"></a-phosphene>
        <a-phosphene id="p10002" x="-0.3" y="-0.15"></a-phosphene>
        <a-phosphene id="p10003" x="-0.1" y="0"></a-phosphene>
        <a-phosphene id="p10004" x="0" y="0.25"></a-phosphene>
        <a-phosphene id="p10005" x="0" y="-0.25"></a-phosphene>
        <a-phosphene id="p10006" x="0.1" y="0"></a-phosphene>
        <a-phosphene id="p10007" x="0.3" y="0.15"></a-phosphene>
        <a-phosphene id="p10008" x="0.3" y="-0.15"></a-phosphene>
      </a-entity>
    </a-scene>
  </body>

  <script>
    var intensity = 0;
    $(document).ready((e) => { 
      setInterval(() => {
        document.querySelectorAll('a-phosphene').forEach(el => el.setAttribute('intensity', Math.sin(intensity)));
        intensity = intensity + 0.1;
      }, 20)
    });
  </script>
</html>